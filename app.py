import streamlit as st
import sqlite3
import pandas as pd
from reportlab.pdfgen import canvas # Make sure reportlab is installed (`pip install reportlab`)

# ğŸ“Œ Î¡ÏÎ¸Î¼Î¹ÏƒÎ· Streamlit UI (Ï€ÏÏÏ„Î· ÎµÎ½Ï„Î¿Î»Î® Streamlit)
st.set_page_config(
    page_title="Î ÏÎ¿Î³ÏÎ±Î¼Î¼Î±Ï„Î¹ÏƒÎ¼ÏŒÏ‚ Î•Î½ÎµÏÎ³ÎµÎ¹ÏÎ½",
    page_icon="ğŸ“‹",
    layout="wide"
)

# ğŸ“Œ Î£ÏÎ½Î´ÎµÏƒÎ· Î¼Îµ Î²Î¬ÏƒÎ· Î´ÎµÎ´Î¿Î¼Î­Î½Ï‰Î½ SQLite
conn = sqlite3.connect("tasks.db")
cursor = conn.cursor()

# ğŸ“Œ Î”Î¹Î±Î³ÏÎ±Ï†Î® Ï…Ï€Î¬ÏÏ‡Î¿Î½Ï„Î¿Ï‚ Ï€Î¯Î½Î±ÎºÎ± Î³Î¹Î± Î½Î± ÎµÎ¾Î±ÏƒÏ†Î±Î»Î¹ÏƒÏ„ÎµÎ¯ ÏƒÏ‰ÏƒÏ„ÏŒ ÏƒÏ‡Î®Î¼Î± (Î Î¡ÎŸÎ£ÎŸÎ§Î—: Î”Î¹Î±Î³ÏÎ¬Ï†ÎµÎ¹ ÏŒÎ»Î± Ï„Î± Î´ÎµÎ´Î¿Î¼Î­Î½Î±!)
cursor.execute("DROP TABLE IF EXISTS tasks")

# ğŸ“Œ Î”Î·Î¼Î¹Î¿Ï…ÏÎ³Î¯Î± Ï€Î¯Î½Î±ÎºÎ±
cursor.execute("""
CREATE TABLE tasks (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    user_name TEXT,
    month TEXT,
    date TEXT,
    title TEXT,
    task TEXT,
    completed INTEGER
)
""")
conn.commit()

# ğŸ“Œ Î ÏÎ¿ÎºÎ±Î¸Î¿ÏÎ¹ÏƒÎ¼Î­Î½ÎµÏ‚ ÎµÏÎ³Î±ÏƒÎ¯ÎµÏ‚ Î±Î½Î¬ Î¼Î®Î½Î±
predefined_tasks = {
    "Î£ÎµÏ€Ï„Î­Î¼Î²ÏÎ¹Î¿Ï‚": [
        ("1/9", "Î ÏÎ¬Î¾Î· Î±Î½Î¬Î»Î·ÏˆÎ·Ï‚ Ï…Ï€Î·ÏÎµÏƒÎ¯Î±Ï‚"),
        ("1-5/9", "Î ÏÎ¿Î³ÏÎ±Î¼Î¼Î±Ï„Î¹ÏƒÎ¼ÏŒÏ‚ Î±Î³Î¹Î±ÏƒÎ¼Î¿Ï - ÎµÎ½Î·Î¼Î­ÏÏ‰ÏƒÎ· Î³Î¿Î½Î­Ï‰Î½ - Î±Î½Î¬ÏÏ„Î·ÏƒÎ· ÏƒÏ„Î·Î½ Î¹ÏƒÏ„Î¿ÏƒÎµÎ»Î¯Î´Î±"),
        ("Î­Ï‰Ï‚ 10/9", "Î ÏÎ±ÎºÏ„Î¹ÎºÏŒ: Î‘Î½Î¬Î¸ÎµÏƒÎ· Ï„Î¼Î·Î¼Î¬Ï„Ï‰Î½ - Î´Î¹Î´Î±ÏƒÎºÎ±Î»Î¹ÏÎ½ - Î¿Î»Î¿Î®Î¼ÎµÏÎ¿Ï… - Î Î–"),
        ("Î­Ï‰Ï‚ 10/9", "Î ÏÎ±ÎºÏ„Î¹ÎºÏŒ: Î”Î¹Î±Î¼ÏŒÏÏ†Ï‰ÏƒÎ· Î¿Î¼Î¯Î»Ï‰Î½ ÏƒÏ„Î¿ Î±Î½Î±Î²Î±Î¸Î¼Î¹ÏƒÎ¼Î­Î½Î¿ Ï€ÏÏŒÎ³ÏÎ±Î¼Î¼Î± Î¿Î»Î¿Î·Î¼Î­ÏÎ¿Ï… (Ï€ÏÎ¿Ï„Î¬ÏƒÎµÎ¹Ï‚ Î±Ï€ÏŒ Ï„Î± Î¬Ï„Î¿Î¼Î± Ï€Î¿Ï… Î¸Î± Î´Î¹Î´Î¬ÏƒÎºÎ¿Ï…Î½)"),
        ("Î­Ï‰Ï‚ 10/9", "Î ÏÎ±ÎºÏ„Î¹ÎºÏŒ: Î•Î¾Ï‰Î´Î¹Î´Î±ÎºÏ„Î¹ÎºÎ­Ï‚ Î±ÏÎ¼Î¿Î´Î¹ÏŒÏ„Î·Ï„ÎµÏ‚"),
        ("Î­Ï‰Ï‚ 10/9", "Î ÏÎ±ÎºÏ„Î¹ÎºÏŒ: Î‘Î½Î¬Î¸ÎµÏƒÎ· ÏƒÏ‡Î¿Î»Î¹ÎºÏÎ½ ÎµÎ¿ÏÏ„ÏÎ½, ÎµÏ€ÎµÏ„ÎµÎ¯Ï‰Î½, Î¿Î¼Î¹Î»Î¹ÏÎ½"),
        ("Î­Ï‰Ï‚ 10/9", "Î ÏÎ±ÎºÏ„Î¹ÎºÏŒ: Î•Ï†Î·Î¼ÎµÏÎ¯ÎµÏ‚ - Î±ÏƒÏ†Î¬Î»ÎµÎ¹Î± Î¼Î±Î¸Î·Ï„ÏÎ½"),
        ("Î­Ï‰Ï‚ 10/9", "Î ÏÎ±ÎºÏ„Î¹ÎºÏŒ: Î‘Î½Î±Ï€Î»Î®ÏÏ‰ÏƒÎ· Î±Ï€ÏŒÎ½Ï„Ï‰Î½ ÎµÎºÏ€Î±Î¹Î´ÎµÏ…Ï„Î¹ÎºÏÎ½"),
        ("Î­Ï‰Ï‚ 10/9", "Î ÏÎ±ÎºÏ„Î¹ÎºÏŒ: Î•Ï€Î¹Î»Î¿Î³Î® Î²Î¹Î²Î»Î¯Ï‰Î½ Î’â€™ Î¾Î­Î½Î·Ï‚ Î³Î»ÏÏƒÏƒÎ±Ï‚"),
        ("Î­Ï‰Ï‚ 10/9", "Î•ÏƒÏ‰Ï„ÎµÏÎ¹ÎºÏŒÏ‚ ÎºÎ±Î½Î¿Î½Î¹ÏƒÎ¼ÏŒÏ‚ Î»ÎµÎ¹Ï„Î¿Ï…ÏÎ³Î¯Î±Ï‚ - ÎµÏ€Î¹ÎºÎ±Î¹ÏÎ¿Ï€Î¿Î¯Î·ÏƒÎ· - Î±Î½Î¬ÏÏ„Î·ÏƒÎ· ÏƒÏ„Î·Î½ Î¹ÏƒÏ„Î¿ÏƒÎµÎ»Î¯Î´Î± Ï„Î¿Ï… ÏƒÏ‡Î¿Î»ÎµÎ¯Î¿Ï…"),
        ("Î­Ï‰Ï‚ 10/9", "Î£Ï‡Î¿Î»Î¹ÎºÏŒ Î£Ï…Î¼Î²Î¿ÏÎ»Î¹Î¿; ÎšÎ¿Î¹Î½Î® ÏƒÏ…Î½ÎµÎ´ÏÎ¯Î±ÏƒÎ· ÏƒÏ…ÏƒÏ„ÎµÎ³Î±Î¶ÏŒÎ¼ÎµÎ½Ï‰Î½"),
        ("Î­Ï‰Ï‚ 10/9", "ÎŸÏÎ³Î¬Î½Ï‰ÏƒÎ· Ï„Î¿Ï… Myschool (Î‘Î½Î±Î»Î®ÏˆÎµÎ¹Ï‚ Ï…Ï€Î·ÏÎµÏƒÎ¯Î±Ï‚, Î­Î»ÎµÎ³Ï‡Î¿Ï‚-ÎµÎ³Î³ÏÎ±Ï†Î® Î¼Î±Î¸Î·Ï„ÏÎ½ Î‘, Ï„Î¼Î®Î¼Î±Ï„Î±, ÎŸÎ»Î¿Î®Î¼ÎµÏÎ¿, Î ÏÏ‰Î¹Î½Î® Î–ÏÎ½Î·, Î±Î½Î±Î¸Î­ÏƒÎµÎ¹Ï‚ Î¼Î±Î¸Î·Î¼Î¬Ï„Ï‰Î½, Î¼Î±Î¸Î·Ï„Î­Ï‚ Î¼Îµ ÎµÎ¹Î´Î¹ÎºÎ­Ï‚ ÎµÎºÏ€Î±Î¹Î´ÎµÏ…Ï„Î¹ÎºÎ­Ï‚ Î±Î½Î¬Î³ÎºÎµÏ‚)"),
        ("11/9", "Î©ÏÎ¿Î»ÏŒÎ³Î¹Î¿ Ï€ÏÏŒÎ³ÏÎ±Î¼Î¼Î± - (Î­ÏƒÏ„Ï‰ Ï€ÏÎ¿ÏƒÏ‰ÏÎ¹Î½ÏŒ)"),
        ("11/9", "Î©ÏÎ¿Î»ÏŒÎ³Î¹Î¿ Ï€ÏÏŒÎ³ÏÎ±Î¼Î¼Î± ÎµÎ¾ Î±Ï€Î¿ÏƒÏ„Î¬ÏƒÎµÏ‰Ï‚"),
        ("11/9", "Î‘Î³Î¹Î±ÏƒÎ¼ÏŒÏ‚. ÎšÎ±Î»Ï‰ÏƒÏŒÏÎ¹ÏƒÎ¼Î± - Ï…Ï€Î¿Î´Î¿Ï‡Î® Î³Î¿Î½Î­Ï‰Î½ Î‘â€™ Ï„Î¬Î¾Î·Ï‚"),
        ("12/9", "Î‘Ï€Î¿ÏƒÏ„Î¿Î»Î® Î´Î·Î»ÏÏƒÎµÏ‰Î½ ÏƒÏ„Î¿Ï…Ï‚ Î³Î¿Î½ÎµÎ¯Ï‚ Ï„Ï‰Î½ Ï€Î±Î¹Î´Î¹ÏÎ½ Ï€Î¿Ï… ÎµÏ€Î­Î»ÎµÎ¾Î±Î½ Ï„Î· ÏƒÏ…Î¼Î¼ÎµÏ„Î¿Ï‡Î® ÏƒÏ„Î¿ Î±Î½Î±Î²Î±Î¸Î¼Î¹ÏƒÎ¼Î­Î½Î¿ Î¿Î»Î¿Î®Î¼ÎµÏÎ¿ Î³Î¹Î± Ï„Î·Î½ ÎµÏ€Î¹Î»Î¿Î³Î® Ï„Ï‰Î½ Î¿Î¼Î¯Î»Ï‰Î½."),
        ("15/9", "Î•Ï€Î¹Î²ÎµÎ²Î±Î¯Ï‰ÏƒÎ· Î”ÎµÎ´Î¿Î¼Î­Î½Ï‰Î½ Myschool"),
        ("Î­Ï‰Ï‚ 20", "ÎŸÏÎ¹ÏƒÎ¼ÏŒÏ‚ ÏƒÏ…Î½Ï„Î¿Î½Î¹ÏƒÏ„ÏÎ½"),
        ("Î­Ï‰Ï‚ 20", "ÎŸÏÎ¹ÏƒÎ¼ÏŒÏ‚ Î¼Î­Î½Ï„Î¿ÏÎ±"),
        ("Î­Ï‰Ï‚ 20", "Î ÏÎ¿Î±Î¹ÏÎµÏ„Î¹ÎºÎ® Î£Ï…Î³ÎºÏÏŒÏ„Î·ÏƒÎ· Î•ÎºÏ€Î±Î¹Î´ÎµÏ…Ï„Î¹ÎºÏÎ½ ÎŸÎ¼Î¯Î»Ï‰Î½"),
        ("Î­Ï‰Ï‚ 20/9", "Î ÏÎ¿Î³ÏÎ±Î¼Î¼Î±Ï„Î¹ÏƒÎ¼ÏŒÏ‚ ÏƒÏ…Î½Î±Î½Ï„Î®ÏƒÎµÏ‰Î½ Î¼Îµ Î³Î¿Î½ÎµÎ¯Ï‚ (Î¿Î¹ ÏƒÏ…Î½Î±Î½Ï„Î®ÏƒÎµÎ¹Ï‚ Î¼Ï€Î¿ÏÎ¿ÏÎ½ Î½Î± Î³Î¯Î½Î¿Ï…Î½ 26-30/9)"),
        ("Î­Ï‰Ï‚ 30/9", "Î•Î¹Î´Î¹ÎºÎ® ÏƒÏ…Î½ÎµÎ´ÏÎ¯Î±ÏƒÎ· Ï„Î¿Ï… Î£Ï…Î»Î»ÏŒÎ³Î¿Ï… Î”Î¹Î´Î±ÏƒÎºÏŒÎ½Ï„Ï‰Î½ Î³Î¹Î± Ï„Î¿Î½ ÎºÎ±Î¸Î¿ÏÎ¹ÏƒÎ¼ÏŒ Ï„Î¿Ï… ÎµÏ„Î®ÏƒÎ¹Î¿Ï… Î£Ï‡ÎµÎ´Î¯Î¿Ï… Î”ÏÎ¬ÏƒÎ·Ï‚ Ï„Î·Ï‚ ÏƒÏ‡Î¿Î»Î¹ÎºÎ®Ï‚ Î¼Î¿Î½Î¬Î´Î±Ï‚ Î±Î½Î±Ï†Î¿ÏÎ¹ÎºÎ¬ Î¼Îµ Ï„Î± Î•ÏÎ³Î±ÏƒÏ„Î®ÏÎ¹Î± Î”ÎµÎ¾Î¹Î¿Ï„Î®Ï„Ï‰Î½"),
        ("Î­Ï‰Ï‚ 30/9", "Î ÏÎ¿Î³ÏÎ±Î¼Î¼Î±Ï„Î¹ÏƒÎ¼ÏŒÏ‚ 15Ï‰ÏÏ‰Î½ ÎµÎ½Î´Î¿ÏƒÏ‡Î¿Î»Î¹ÎºÏÎ½ (ÎµÎ¯Î½Î±Î¹ Î±ÏÎ¼Î¿Î´Î¹ÏŒÏ„Î·Ï„Î± Ï„Î¿Ï… Î”Î¹ÎµÏ…Î¸Ï…Î½Ï„Î® Î±Î»Î»Î¬ ÎµÎ¯Î½Î±Î¹ Ï‡ÏÎ®ÏƒÎ¹Î¼Î¿ - ÎºÎ±Î¹ Î´ÎµÏƒÎ¼ÎµÏ…Ï„Î¹ÎºÏŒ - Î½Î± ÎµÏÏ‰Ï„Î¬Ï„Î±Î¹ Î¿ Î£ÏÎ»Î»Î¿Î³Î¿Ï‚ Î”Î¹Î´Î±ÏƒÎºÏŒÎ½Ï„Ï‰Î½)"),
        ("Î­Ï‰Ï‚ 30/9", "ÎˆÎ»ÎµÎ³Ï‡Î¿Ï‚ Î¼Î±Î¸Î·Ï„Î¹ÎºÏÎ½ Î»Î¿Î³Î±ÏÎ¹Î±ÏƒÎ¼ÏÎ½ Ï„Ï‰Î½ Î¼Î±Î¸Î·Ï„ÏÎ½ Ï„Î·Ï‚ Î‘ Ï„Î¬Î¾Î·Ï‚ ÎºÎ±Î¹ Ï„Ï‰Î½ ÎµÎº Î¼ÎµÏ„ÎµÎ³Î³ÏÎ±Ï†Î®Ï‚ ÏƒÏ„Î¿ sch.gr"),
        ("Î­Ï‰Ï‚ 30/9", "Î ÏÎ¿Î³ÏÎ±Î¼Î¼Î±Ï„Î¹ÏƒÎ¼ÏŒÏ‚ Î‘â€™ Ï„ÏÎ¹Î¼Î®Î½Î¿Ï… (ÎµÏ€Î¹ÏƒÎºÎ­ÏˆÎµÎ¹Ï‚, ÎµÎºÎ´ÏÎ¿Î¼Î­Ï‚, Î·Î¼Î­ÏÎµÏ‚ ÎºÎ±Î¹ ÏÏÎµÏ‚ Ï€Î¿Ï… Î¿Î¹ ÎµÎºÏ€Î±Î¹Î´ÎµÏ…Ï„Î¹ÎºÎ¿Î¯ Î´Î­Ï‡Î¿Î½Ï„Î±Î¹ Î³Î¿Î½ÎµÎ¯Ï‚)"),
        ("Î­Ï‰Ï‚ 30/9", "Î”Î¹Î±Î´Î¹ÎºÎ±ÏƒÎ¯Î± Î±Î½Î¬Î¸ÎµÏƒÎ·Ï‚ ÎºÎ±Î¹ Î­Î³ÎºÏÎ¹ÏƒÎ·Ï‚ Î³Î¹Î± Ï„Î· ÏƒÏ…Î¼Ï€Î»Î®ÏÏ‰ÏƒÎ· Ï„Î¿Ï… Ï…Ï€Î¿Ï‡ÏÎµÏ‰Ï„Î¹ÎºÎ¿Ï Î´Î¹Î´Î±ÎºÏ„Î¹ÎºÎ¿Ï Ï‰ÏÎ±ÏÎ¯Î¿Ï… (Ï€ÏÎ¿Ï„ÎµÏÎ±Î¹ÏŒÏ„Î·Ï„Î± ÎµÎ½Î¹ÏƒÏ‡Ï…Ï„Î¹ÎºÎ® Î´Î¹Î´Î±ÏƒÎºÎ±Î»Î¯Î±, Î³ÏÎ±Î¼Î¼Î±Ï„ÎµÎ¹Î±ÎºÎ® Ï…Ï€Î¿ÏƒÏ„Î®ÏÎ¹Î¾Î·) (Î. 4386/2016, Î¬ÏÎ¸ÏÎ¿ 33, Ï€Î±Ï. 5, ÏŒÏ€Ï‰Ï‚ Ï„ÏÎ¿Ï€Î¿Ï€Î¿Î¹Î®Î¸Î·ÎºÎµ ÎºÎ±Î¹ Î¹ÏƒÏ‡ÏÎµÎ¹)"),
        ("30/9-3/10", "Î‘Î½Î¬ÏÏ„Î·ÏƒÎ· Ï€Î±ÏÎ¿Ï…ÏƒÎ¹Î¿Î»Î¿Î³Î¯Ï‰Î½ Î•Î£Î Î‘"),
    ],
    "ÎŸÎºÏ„ÏÎ²ÏÎ¹Î¿Ï‚": [
        ("1/10", "Î•Ï€Î¹Î²ÎµÎ²Î±Î¯Ï‰ÏƒÎ· Î”ÎµÎ´Î¿Î¼Î­Î½Ï‰Î½ Myschool"),
        (None, "1Î· Ï€Î±Î¹Î´Î±Î³Ï‰Î³Î¹ÎºÎ® ÏƒÏ…Î½ÎµÎ´ÏÎ¯Î±ÏƒÎ·"),
        ("4/10", "Î Î±Î³ÎºÏŒÏƒÎ¼Î¹Î± Î·Î¼Î­ÏÎ± Ï„Ï‰Î½ Î¶ÏÏ‰Î½"),
        ("5/10", "Î Î±Î³ÎºÏŒÏƒÎ¼Î¹Î± Î—Î¼Î­ÏÎ± Î•ÎºÏ€Î±Î¹Î´ÎµÏ…Ï„Î¹ÎºÏÎ½"),
        ("Î­Ï‰Ï‚ 10/10", "ÎœÎ½Î·Î¼ÏŒÎ½Î¹Î¿ ÎµÎ½ÎµÏÎ³ÎµÎ¹ÏÎ½ ÎµÎºÏ„Î¬ÎºÏ„Ï‰Î½ Î±Î½Î±Î³ÎºÏÎ½ - Î•Î½Î·Î¼Î­ÏÏ‰ÏƒÎ· Î³Î¿Î½Î­Ï‰Î½ ÏƒÏ„Î·Î½ Î¹ÏƒÏ„Î¿ÏƒÎµÎ»Î¯Î´Î±."),
        ("Î­Ï‰Ï‚ 10/10", "Î£Ï…Î½ÎµÎ´ÏÎ¯Î±ÏƒÎ· Î³Î¹Î± Ï„Î¿Î½ Î£Ï…Î»Î»Î¿Î³Î¹ÎºÏŒ Î ÏÎ¿Î³ÏÎ±Î¼Î¼Î±Ï„Î¹ÏƒÎ¼ÏŒ ÏŒÏ€Î¿Ï… Ï€ÏÎ¿Ï„ÎµÎ¯Î½Î¿Î½Ï„Î±Î¹ Î£Ï‡Î­Î´Î¹Î± Î”ÏÎ¬ÏƒÎ·Ï‚, ÏƒÏ…Î³ÎºÏÎ¿Ï„Î¿ÏÎ½Ï„Î±Î¹ ÎŸÎ¼Î¬Î´ÎµÏ‚ Î”ÏÎ¬ÏƒÎ·Ï‚"),
        ("15/10", "Î•Ï€Î¹Î²ÎµÎ²Î±Î¯Ï‰ÏƒÎ· Î”ÎµÎ´Î¿Î¼Î­Î½Ï‰Î½ Myschool"),
        ("Î­Ï‰Ï‚ 20/10", "ÎšÎ±Ï„Î±Ï‡ÏÏÎ·ÏƒÎ· Ï„Î¯Ï„Î»Ï‰Î½ & ÏƒÏ‡ÎµÎ´Î¯Ï‰Î½ Î´ÏÎ¬ÏƒÎ·Ï‚ ÏƒÏ„Î·Î½ Ï€Î»Î±Ï„Ï†ÏŒÏÎ¼Î±"),
        ("Î­Ï‰Ï‚ 21/10", "Î•Ï€Î¹Î»Î¿Î³Î® ÏƒÎ·Î¼Î±Î¹Î¿Ï†ÏŒÏÏ‰Î½"),
        ("31/10-3/11", "Î‘Î½Î¬ÏÏ„Î·ÏƒÎ· Ï€Î±ÏÎ¿Ï…ÏƒÎ¹Î¿Î»Î¿Î³Î¯Ï‰Î½ Î•Î£Î Î‘"),
    ],
    "ÎÎ¿Î­Î¼Î²ÏÎ¹Î¿Ï‚": [
        ("1/11", "Î•Ï€Î¹Î²ÎµÎ²Î±Î¯Ï‰ÏƒÎ· Î”ÎµÎ´Î¿Î¼Î­Î½Ï‰Î½ Myschool"),
        (None, "2Î· Ï€Î±Î¹Î´Î±Î³Ï‰Î³Î¹ÎºÎ® ÏƒÏ…Î½ÎµÎ´ÏÎ¯Î±ÏƒÎ·"),
        ("Î­Ï‰Ï‚ 10/11", "Î£Ï‡Î¿Î»Î¹ÎºÏŒ Î£Ï…Î¼Î²Î¿ÏÎ»Î¹Î¿"),
        ("15/11", "Î•Ï€Î¹Î²ÎµÎ²Î±Î¯Ï‰ÏƒÎ· Î”ÎµÎ´Î¿Î¼Î­Î½Ï‰Î½ Myschool"),
        ("20/11", "Î Î±Î³ÎºÏŒÏƒÎ¼Î¹Î± Î—Î¼Î­ÏÎ± Î³Î¹Î± Ï„Î± Î´Î¹ÎºÎ±Î¹ÏÎ¼Î±Ï„Î± Ï„Î¿Ï… Î Î±Î¹Î´Î¹Î¿Ï"),
        ("30/11-2/12", "Î‘Î½Î¬ÏÏ„Î·ÏƒÎ· Ï€Î±ÏÎ¿Ï…ÏƒÎ¹Î¿Î»Î¿Î³Î¯Ï‰Î½ Î•Î£Î Î‘"),
    ],
    "Î”ÎµÎºÎ­Î¼Î²ÏÎ¹Î¿Ï‚": [
        ("1/12", "Î•Ï€Î¹Î²ÎµÎ²Î±Î¯Ï‰ÏƒÎ· Î”ÎµÎ´Î¿Î¼Î­Î½Ï‰Î½ Myschool"),
        ("3/12", "Î Î±Î³ÎºÏŒÏƒÎ¼Î¹Î± Î—Î¼Î­ÏÎ± Î‘Ï„ÏŒÎ¼Ï‰Î½ Î¼Îµ Î‘Î½Î±Ï€Î·ÏÎ¯Î±"),
        ("Î­Ï‰Ï‚ 10/12", "ÎšÎ±Ï„Î±Ï‡ÏÏÎ·ÏƒÎ· Ï„Î¿Ï… Î£Ï‡ÎµÎ´Î¹Î±ÏƒÎ¼Î¿Ï Î”ÏÎ¬ÏƒÎ·Ï‚ Î±Ï€ÏŒ Ï„Î¿Ï…Ï‚ Î£Î¥ÎÎ¤ÎŸÎÎ™Î£Î¤Î•Î£ ÎŸÎœÎ‘Î”Î©Î Î”Î¡Î‘Î£Î—Î£"),
        (None, "3Î· Ï€Î±Î¹Î´Î±Î³Ï‰Î³Î¹ÎºÎ® ÏƒÏ…Î½ÎµÎ´ÏÎ¯Î±ÏƒÎ· - Î ÏÎ¿Î³ÏÎ±Î¼Î¼Î±Ï„Î¹ÏƒÎ¼ÏŒÏ‚ Î’â€™ Ï„ÏÎ¹Î¼Î®Î½Î¿Ï… (ÎµÏ€Î¹ÏƒÎºÎ­ÏˆÎµÎ¹Ï‚, ÎµÎºÎ´ÏÎ¿Î¼Î­Ï‚)"),
        ("10/12", "Î›Î®Î¾Î· Î‘â€™ Ï„ÏÎ¹Î¼Î®Î½Î¿Ï…"),
        (None, "Î•Ï€Î¯Î´Î¿ÏƒÎ· ÎµÎ»Î­Î³Ï‡Ï‰Î½"),
        ("15/12", "Î•Ï€Î¹Î²ÎµÎ²Î±Î¯Ï‰ÏƒÎ· Î”ÎµÎ´Î¿Î¼Î­Î½Ï‰Î½ Myschool"),
        ("23/12-9/1/23", "Î‘Î½Î¬ÏÏ„Î·ÏƒÎ· Ï€Î±ÏÎ¿Ï…ÏƒÎ¹Î¿Î»Î¿Î³Î¯Ï‰Î½ Î•Î£Î Î‘"),
        ("23/12 Î­Ï‰Ï‚ ÎºÎ±Î¹ 7/1", "Î”Î¹Î±ÎºÎ¿Ï€Î­Ï‚ Î§ÏÎ¹ÏƒÏ„Î¿Ï…Î³Î­Î½Î½Ï‰Î½"),
    ],
    "Î™Î±Î½Î¿Ï…Î¬ÏÎ¹Î¿Ï‚": [
        ("9/1", "Î•Ï€Î¹Î²ÎµÎ²Î±Î¯Ï‰ÏƒÎ· Î”ÎµÎ´Î¿Î¼Î­Î½Ï‰Î½ Myschool"),
        (None, "4Î· Ï€Î±Î¹Î´Î±Î³Ï‰Î³Î¹ÎºÎ® ÏƒÏ…Î½ÎµÎ´ÏÎ¯Î±ÏƒÎ·"),
        ("Î­Ï‰Ï‚ 15/1", "Î£Ï‡Î¿Î»Î¹ÎºÏŒ Î£Ï…Î¼Î²Î¿ÏÎ»Î¹Î¿"),
        ("15/1", "Î•Ï€Î¹Î²ÎµÎ²Î±Î¯Ï‰ÏƒÎ· Î”ÎµÎ´Î¿Î¼Î­Î½Ï‰Î½ Myschool"),
        ("31/1-3/2", "Î‘Î½Î¬ÏÏ„Î·ÏƒÎ· Ï€Î±ÏÎ¿Ï…ÏƒÎ¹Î¿Î»Î¿Î³Î¯Ï‰Î½ Î•Î£Î Î‘"),
    ],
    "Î¦ÎµÎ²ÏÎ¿Ï…Î¬ÏÎ¹Î¿Ï‚": [
        ("1/2", "Î•Ï€Î¹Î²ÎµÎ²Î±Î¯Ï‰ÏƒÎ· Î”ÎµÎ´Î¿Î¼Î­Î½Ï‰Î½ Myschool"),
        (None, "Î—Î¼Î­ÏÎ± Î‘ÏƒÏ†Î±Î»Î¿ÏÏ‚ Î”Î¹Î±Î´Î¹ÎºÏ„ÏÎ¿Ï… â€“ Safer Internet Day"),
        (None, "5Î· Ï€Î±Î¹Î´Î±Î³Ï‰Î³Î¹ÎºÎ® ÏƒÏ…Î½ÎµÎ´ÏÎ¯Î±ÏƒÎ·"),
        ("15/2", "Î•Ï€Î¹Î²ÎµÎ²Î±Î¯Ï‰ÏƒÎ· Î”ÎµÎ´Î¿Î¼Î­Î½Ï‰Î½ Myschool"),
        ("28/2-3/3", "Î‘Î½Î¬ÏÏ„Î·ÏƒÎ· Ï€Î±ÏÎ¿Ï…ÏƒÎ¹Î¿Î»Î¿Î³Î¯Ï‰Î½ Î•Î£Î Î‘"),
    ],
    "ÎœÎ¬ÏÏ„Î¹Î¿Ï‚": [
        ("1/3", "Î•Ï€Î¹Î²ÎµÎ²Î±Î¯Ï‰ÏƒÎ· Î”ÎµÎ´Î¿Î¼Î­Î½Ï‰Î½ Myschool"),
        ("Î­Ï‰Ï‚ 10/3", "Î£Ï‡Î¿Î»Î¹ÎºÏŒ Î£Ï…Î¼Î²Î¿ÏÎ»Î¹Î¿"),
        ("1-20/3", "Î•Î³Î³ÏÎ±Ï†Î­Ï‚-Î‘Ï€Î¿ÏƒÏ„Î¿Î»Î® ÏƒÏ„Î¿Î¹Ï‡ÎµÎ¯Ï‰Î½ ÏƒÏ„Î· Î”Î™Î Î•"),
        ("6/3", "Î Î±Î½ÎµÎ»Î»Î®Î½Î¹Î± Î—Î¼Î­ÏÎ± ÎºÎ±Ï„Î¬ Ï„Î·Ï‚ ÏƒÏ‡Î¿Î»Î¹ÎºÎ®Ï‚ Î²Î¯Î±Ï‚ ÎºÎ±Î¹ Ï„Î¿Ï… ÎµÎºÏ†Î¿Î²Î¹ÏƒÎ¼Î¿Ï"),
        (None, "6Î· Ï€Î±Î¹Î´Î±Î³Ï‰Î³Î¹ÎºÎ® ÏƒÏ…Î½ÎµÎ´ÏÎ¯Î±ÏƒÎ· - Î ÏÎ¿Î³ÏÎ±Î¼Î¼Î±Ï„Î¹ÏƒÎ¼ÏŒÏ‚ Î“â€™ Ï„ÏÎ¹Î¼Î®Î½Î¿Ï… (ÎµÏ€Î¹ÏƒÎºÎ­ÏˆÎµÎ¹Ï‚, ÎµÎºÎ´ÏÎ¿Î¼Î­Ï‚)"),
        ("10/3", "Î›Î®Î¾Î· Î’Î„ Ï„ÏÎ¹Î¼Î®Î½Î¿Ï…"),
        (None, "Î•Ï€Î¯Î´Î¿ÏƒÎ· ÎµÎ»Î­Î³Ï‡Ï‰Î½"),
        ("15/3", "Î•Ï€Î¹Î²ÎµÎ²Î±Î¯Ï‰ÏƒÎ· Î”ÎµÎ´Î¿Î¼Î­Î½Ï‰Î½ Myschool"),
        ("21/3", "Î Î±Î³ÎºÏŒÏƒÎ¼Î¹Î± Î—Î¼Î­ÏÎ± Î Î¿Î¯Î·ÏƒÎ·Ï‚"),
        ("31/3-3/4", "Î‘Î½Î¬ÏÏ„Î·ÏƒÎ· Ï€Î±ÏÎ¿Ï…ÏƒÎ¹Î¿Î»Î¿Î³Î¯Ï‰Î½ Î•Î£Î Î‘"),
    ],
    "Î‘Ï€ÏÎ¯Î»Î¹Î¿Ï‚": [
        ("1/4", "Î•Ï€Î¹Î²ÎµÎ²Î±Î¯Ï‰ÏƒÎ· Î”ÎµÎ´Î¿Î¼Î­Î½Ï‰Î½ Myschool"),
        ("2/4", "Î Î±Î³ÎºÏŒÏƒÎ¼Î¹Î± Î—Î¼Î­ÏÎ± Î Î±Î¹Î´Î¹ÎºÎ¿Ï Î’Î¹Î²Î»Î¯Î¿Ï…"),
        (None, "7Î· Ï€Î±Î¹Î´Î±Î³Ï‰Î³Î¹ÎºÎ® ÏƒÏ…Î½ÎµÎ´ÏÎ¯Î±ÏƒÎ·"),
        ("27/4-12/5", "Î”Î¹Î±ÎºÎ¿Ï€Î­Ï‚ Î Î¬ÏƒÏ‡Î±"),
        ("22/4", "Î—Î¼Î­ÏÎ± Ï„Î·Ï‚ Î“Î·Ï‚"),
        ("23/4", "Î Î±Î³ÎºÏŒÏƒÎ¼Î¹Î± Î—Î¼Î­ÏÎ± Î’Î¹Î²Î»Î¯Î¿Ï…"),
        ("24/4", "Î•Ï€Î¹Î²ÎµÎ²Î±Î¯Ï‰ÏƒÎ· Î”ÎµÎ´Î¿Î¼Î­Î½Ï‰Î½ Myschool"),
        ("28/4-3/5", "Î‘Î½Î¬ÏÏ„Î·ÏƒÎ· Ï€Î±ÏÎ¿Ï…ÏƒÎ¹Î¿Î»Î¿Î³Î¯Ï‰Î½ Î•Î£Î Î‘"),
    ],
    "ÎœÎ¬Î¹Î¿Ï‚": [
        ("1/5", "Î•Ï€Î¹Î²ÎµÎ²Î±Î¯Ï‰ÏƒÎ· Î”ÎµÎ´Î¿Î¼Î­Î½Ï‰Î½ Myschool"),
        (None, "8Î· Ï€Î±Î¹Î´Î±Î³Ï‰Î³Î¹ÎºÎ® ÏƒÏ…Î½ÎµÎ´ÏÎ¯Î±ÏƒÎ·"),
        ("9/5", "Î—Î¼Î­ÏÎ± Ï„Î·Ï‚ Î•Ï…ÏÏÏ€Î·Ï‚"),
        ("15/5", "Î•Ï€Î¹Î²ÎµÎ²Î±Î¯Ï‰ÏƒÎ· Î”ÎµÎ´Î¿Î¼Î­Î½Ï‰Î½ Myschool"),
        ("19/5", "Î—Î¼Î­ÏÎ± ÎœÎ½Î®Î¼Î·Ï‚ Î³Î¹Î± Ï„Î· Î“ÎµÎ½Î¿ÎºÏ„Î¿Î½Î¯Î± Ï„Ï‰Î½ Î•Î»Î»Î®Î½Ï‰Î½ ÏƒÏ„Î¿ ÎœÎ¹ÎºÏÎ±ÏƒÎ¹Î±Ï„Î¹ÎºÏŒ Î ÏŒÎ½Ï„Î¿"),
        (None, "Î›Î®Î¾Î· ÎµÎ½ÎµÏÎ³ÎµÎ¹ÏÎ½ Ï€ÏÎ¿Î³ÏÎ±Î¼Î¼Î±Ï„Î¹ÏƒÎ¼Î¿Ï ÎŸÎ»Î¿Î®Î¼ÎµÏÎ¿Ï… Î ÏÎ¿Î³ÏÎ¬Î¼Î¼Î±Ï„Î¿Ï‚-Î‘Ï€Î¿ÏƒÏ„Î¿Î»Î® ÏƒÏ„Î¿Î¹Ï‡ÎµÎ¯Ï‰Î½ ÏƒÏ„Î· Î”Î™Î Î•"),
        ("Î­Ï‰Ï‚ 31/5", "Î¥Î»Î¿Ï€Î¿Î¯Î·ÏƒÎ· ÎºÎ±Î¹ ÎºÎ±Ï„Î±Ï‡ÏÏÎ·ÏƒÎ· Ï„Î·Ï‚ Î±Ï€Î¿Ï„Î¯Î¼Î·ÏƒÎ·Ï‚ Ï„Ï‰Î½ Î´ÏÎ¬ÏƒÎµÏ‰Î½ Î±Ï€ÏŒ Ï„Î¿Ï…Ï‚ Î£Î¥ÎÎ¤ÎŸÎÎ™Î£Î¤Î•Î£ ÎŸÎœÎ‘Î”Î©Î Î”Î¡Î‘Î£Î—Î£"),
        ("Î­Ï‰Ï‚ 31/5", "Î£Ï‡Î¿Î»Î¹ÎºÏŒ Î£Ï…Î¼Î²Î¿ÏÎ»Î¹Î¿"),
        ("31/5-2/6", "Î‘Î½Î¬ÏÏ„Î·ÏƒÎ· Ï€Î±ÏÎ¿Ï…ÏƒÎ¹Î¿Î»Î¿Î³Î¯Ï‰Î½ Î•Î£Î Î‘"),
    ],
    "Î™Î¿ÏÎ½Î¹Î¿Ï‚": [
        ("1/6", "Î•Ï€Î¹Î²ÎµÎ²Î±Î¯Ï‰ÏƒÎ· Î”ÎµÎ´Î¿Î¼Î­Î½Ï‰Î½ Myschool"),
        (None, "9Î· Ï€Î±Î¹Î´Î±Î³Ï‰Î³Î¹ÎºÎ® ÏƒÏ…Î½ÎµÎ´ÏÎ¯Î±ÏƒÎ· Î³Î¹Î± Ï„Î·Î½ Î­ÎºÎ´Î¿ÏƒÎ· Î±Ï€Î¿Ï„ÎµÎ»ÎµÏƒÎ¼Î¬Ï„Ï‰Î½"),
        ("5/6", "Î Î±Î³ÎºÏŒÏƒÎ¼Î¹Î± Î—Î¼Î­ÏÎ± Î ÎµÏÎ¹Î²Î¬Î»Î»Î¿Î½Ï„Î¿Ï‚"),
        ("15/6", "Î›Î®Î¾Î· Î£Ï‡Î¿Î»Î¹ÎºÎ¿Ï Î­Ï„Î¿Ï…Ï‚"),
        (None, "Î•Ï€Î¯Î´Î¿ÏƒÎ· Ï„Î¯Ï„Î»Ï‰Î½"),
        ("Î­Ï‰Ï‚ 21/6", "Î†Î½Î¿Î¹Î³Î¼Î± Î½Î­Î¿Ï… ÏƒÏ‡Î¿Î»Î¹ÎºÎ¿Ï Î­Ï„Î¿Ï…Ï‚ ÏƒÏ„Î¿ Myschool"),
        ("21/6-23/6", "Î‘Î½Î¬ÏÏ„Î·ÏƒÎ· Ï€Î±ÏÎ¿Ï…ÏƒÎ¹Î¿Î»Î¿Î³Î¯Ï‰Î½ Î•Î£Î Î‘"),
        ("Î­Ï‰Ï‚ 25/6", "ÎšÎ±Ï„Î±Ï‡ÏÏÎ·ÏƒÎ· ÎˆÎºÎ¸ÎµÏƒÎ·Ï‚ Î•ÏƒÏ‰Ï„ÎµÏÎ¹ÎºÎ®Ï‚ Î‘Î¾Î¹Î¿Î»ÏŒÎ³Î·ÏƒÎ·Ï‚ Î±Ï€ÏŒ Ï„Î·/Ï„Î¿Î½ Î”Î¹ÎµÏ…Î¸ÏÎ½Ï„ÏÎ¹Î±/Î½Ï„Î®"),
        (None, "Î”Î·Î¼Î¹Î¿Ï…ÏÎ³Î¯Î± Î½Î­Î¿Ï… ÏƒÏ‡Î¿Î»Î¹ÎºÎ¿Ï Î­Ï„Î¿Ï…Ï‚ - ÎºÎ±Ï„Î±Ï‡ÏÏÎ¹ÏƒÎ·"),
    ],
    "Î™Î¿ÏÎ»Î¹Î¿Ï‚": [],
    "Î‘ÏÎ³Î¿Ï…ÏƒÏ„Î¿Ï‚": [],
}

# ğŸ“Œ Î£Ï…Î½Î¬ÏÏ„Î·ÏƒÎ· Î³Î¹Î± Ï„Î·Î½ Ï€ÏÎ¿ÏƒÎ¸Î®ÎºÎ· Ï€ÏÎ¿ÎºÎ±Î¸Î¿ÏÎ¹ÏƒÎ¼Î­Î½Ï‰Î½ ÎµÏÎ³Î±ÏƒÎ¹ÏÎ½
def add_predefined_tasks(user_name):
    cursor.execute("SELECT COUNT(*) FROM tasks WHERE user_name = ?", (user_name,))
    count = cursor.fetchone()[0]
    if count == 0:
        for month, tasks in predefined_tasks.items():
            for date, task_desc in tasks:
                title = task_desc
                cursor.execute("INSERT INTO tasks (user_name, month, date, title, task, completed) VALUES (?, ?, ?, ?, ?, ?)",
                               (user_name, month, date, title, task_desc, 0))
        conn.commit()
        return True
    return False

# ğŸ“Œ Î‘Î½Î¬ÎºÏ„Î·ÏƒÎ· ÎµÏÎ³Î±ÏƒÎ¹ÏÎ½ Î±Ï€ÏŒ Ï„Î· Î²Î¬ÏƒÎ· Î´ÎµÎ´Î¿Î¼Î­Î½Ï‰Î½
def get_tasks_from_db(user_name, month):
    cursor.execute("SELECT id, date, title, task, completed FROM tasks WHERE user_name = ? AND month = ? ORDER BY date",
                   (user_name, month))
    return cursor.fetchall()

# ğŸ“Œ Î‘ÏÏ‡Î¹ÎºÎ¿Ï€Î¿Î¯Î·ÏƒÎ· Ï„Î·Ï‚ ÎµÏ†Î±ÏÎ¼Î¿Î³Î®Ï‚ ÎºÎ±Î¹ session state
if "user_name" not in st.session_state:
    st.session_state.user_name = "ÎšÏÏƒÏ„Î±Ï‚"
    if add_predefined_tasks(st.session_state.user_name):
        st.info("Adding predefined tasks...")

if 'show_new_task_form' not in st.session_state:
    st.session_state.show_new_task_form = False

# ğŸ“Œ ÎšÎµÏ†Î±Î»Î¯Î´Î±
st.markdown(f"## ğŸ‘‹ Î“ÎµÎ¹Î± ÏƒÎ¿Ï…, {st.session_state.user_name}!")
st.markdown("### ğŸ“‹ Î ÏÎ¿Î³ÏÎ±Î¼Î¼Î±Ï„Î¹ÏƒÎ¼ÏŒÏ‚ ÎµÎ½ÎµÏÎ³ÎµÎ¹ÏÎ½ Î´Î¹ÎµÏ…Î¸Ï…Î½Ï„Î®")
st.write("**Î Î±ÏÎ±ÎºÎ¿Î»Î¿ÏÎ¸Î·ÏƒÎ· ÎœÎ·Î½Î¹Î±Î¯Ï‰Î½ Î•ÏÎ³Î±ÏƒÎ¹ÏÎ½**")

# ğŸ“Œ Î•Ï€Î¹Î»Î¿Î³Î® Î¼Î®Î½Î±
months = list(predefined_tasks.keys())
selected_month = st.selectbox("ğŸ“… Î•Ï€Î¹Î»Î­Î¾Ï„Îµ ÎœÎ®Î½Î±:", months)

# ğŸ“Œ Î‘Î½Î¬ÎºÏ„Î·ÏƒÎ· ÎµÏÎ³Î±ÏƒÎ¹ÏÎ½ Î±Ï€ÏŒ Ï„Î· Î²Î¬ÏƒÎ· Î³Î¹Î± Ï„Î¿Î½ ÎµÏ€Î¹Î»ÎµÎ³Î¼Î­Î½Î¿ Î¼Î®Î½Î± ÎºÎ±Î¹ Ï‡ÏÎ®ÏƒÏ„Î·
tasks = get_tasks_from_db(st.session_state.user_name, selected_month)

# ğŸ“Œ Î¥Ï€Î¿Î»Î¿Î³Î¹ÏƒÎ¼ÏŒÏ‚ Ï€ÏÎ¿ÏŒÎ´Î¿Ï… Î³Î¹Î± Ï„Î¿Î½ Ï„ÏÎ­Ï‡Î¿Î½Ï„Î± Î¼Î®Î½Î±
total_tasks = len(tasks)
completed_tasks = sum(1 for task in tasks if task[4] == 1)
progress_percentage = (completed_tasks / total_tasks) * 100 if total_tasks > 0 else 0

# ğŸ“Œ Î•Î¼Ï†Î¬Î½Î¹ÏƒÎ· Î³ÏÎ±Î¼Î¼Î®Ï‚ Ï€ÏÎ¿ÏŒÎ´Î¿Ï…
st.markdown(f"### ğŸ“Š Î ÏÏŒÎ¿Î´Î¿Ï‚ {selected_month}")
st.progress(progress_percentage / 100.0, text=f"{completed_tasks} / {total_tasks} ÎµÏÎ³Î±ÏƒÎ¯ÎµÏ‚ Î¿Î»Î¿ÎºÎ»Î·ÏÏÎ¸Î·ÎºÎ±Î½ ({progress_percentage:.0f}%)")

# ğŸ“Œ Î•Î¼Ï†Î¬Î½Î¹ÏƒÎ· ÎµÏÎ³Î±ÏƒÎ¹ÏÎ½ Î¼Îµ checkbox & Ï€ÎµÏÎ¹Î³ÏÎ±Ï†Î®
st.markdown(f"### ğŸ“Œ Î›Î¯ÏƒÏ„Î± ÎµÏÎ³Î±ÏƒÎ¹ÏÎ½ {selected_month}")
if not tasks:
    st.info(f"Î”ÎµÎ½ Ï…Ï€Î¬ÏÏ‡Î¿Ï…Î½ ÎºÎ±Ï„Î±Ï‡Ï‰ÏÎ·Î¼Î­Î½ÎµÏ‚ ÎµÏÎ³Î±ÏƒÎ¯ÎµÏ‚ Î³Î¹Î± Ï„Î¿Î½ Î¼Î®Î½Î± {selected_month}.")
else:
    for task_id, date, title, task, completed in tasks:
        task_key = f"task_{task_id}_{selected_month}"
        col1, col2, col3 = st.columns([0.5, 6, 0.5])
        with col1:
            is_completed = completed == 1
            st.checkbox("", key=task_key, value=is_completed, on_change=lambda tid=task_id, current_state=is_completed: cursor.execute("UPDATE tasks SET completed = ? WHERE id = ?", (0 if current_state else 1, tid)) or conn.commit() or st.rerun())
        with col2:
            tag_color = "ğŸŸ¢" if completed else "ğŸ”´"
            display_date = date if date else "Î§Ï‰ÏÎ¯Ï‚ Î—Î¼."
            display_title = f"**{display_date} | {title}**"
            st.markdown(f"{display_title} {tag_color}")
            if title != task:
                st.write(task)
        with col3:
            if st.button("ğŸ—‘ï¸", key=f"delete_{task_key}"):
                cursor.execute("DELETE FROM tasks WHERE id = ?", (task_id,))
                conn.commit()
                st.rerun()

# ğŸ“Œ ÎšÎ¿Ï…Î¼Ï€Î¯ Î³Î¹Î± ÎµÎ¼Ï†Î¬Î½Î¹ÏƒÎ· Ï„Î·Ï‚ Ï†ÏŒÏÎ¼Î±Ï‚ Ï€ÏÎ¿ÏƒÎ¸Î®ÎºÎ·Ï‚ Î½Î­Î±Ï‚ ÎµÏÎ³Î±ÏƒÎ¯Î±Ï‚
if st.button("âœ¨ Î ÏÎ¿ÏƒÎ¸Î®ÎºÎ· ÎÎ­Î±Ï‚ Î•ÏÎ³Î±ÏƒÎ¯Î±Ï‚"):
    st.session_state.show_new_task_form = True

# ğŸ“Œ Î¦ÏŒÏÎ¼Î± Ï€ÏÎ¿ÏƒÎ¸Î®ÎºÎ·Ï‚ Î½Î­Î±Ï‚ ÎµÏÎ³Î±ÏƒÎ¯Î±Ï‚
if st.session_state.show_new_task_form:
    st.markdown("### ğŸ“ Î£Ï„Î¿Î¹Ï‡ÎµÎ¯Î± ÎÎ­Î±Ï‚ Î•ÏÎ³Î±ÏƒÎ¯Î±Ï‚")
    with st.form("new_task_form", clear_on_submit=False):
        default Bout_date_prefix = ""
        new_task_date = st.text_input("ğŸ“… Î—Î¼ÎµÏÎ¿Î¼Î·Î½Î¯Î± (Ï€.Ï‡. 15/9, Î­Ï‰Ï‚ 20/9, 1-5/9) - Î ÏÎ¿Î±Î¹ÏÎµÏ„Î¹ÎºÏŒ:", value=default_date_prefix, key='new_task_date_input')
        new_task_title = st.text_input("ğŸ“Œ Î¤Î¯Ï„Î»Î¿Ï‚ Î•ÏÎ³Î±ÏƒÎ¯Î±Ï‚ (Î§ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÎµÎ¯Ï„Î±Î¹ ÏƒÏ„Î·Î½ Ï€ÎµÏÎ¯Î»Î·ÏˆÎ· Ï„Î·Ï‚ Î»Î¯ÏƒÏ„Î±Ï‚):", key='new_task_title_input')
        new_task_text = st.text_area("ğŸ“ Î ÎµÏÎ¹Î³ÏÎ±Ï†Î® Î•ÏÎ³Î±ÏƒÎ¯Î±Ï‚ (Î Î»Î®ÏÎµÏ‚ ÎºÎµÎ¯Î¼ÎµÎ½Î¿):", key='new_task_text_area')
        submitted = st.form_submit_button("âœ… Î‘Ï€Î¿Î¸Î®ÎºÎµÏ…ÏƒÎ· Î•ÏÎ³Î±ÏƒÎ¯Î±Ï‚")
        cancel_button = st.form_submit_button("âŒ Î‘ÎºÏÏÏ‰ÏƒÎ·")
        if submitted and new_task_text:
            title_to_insert = new_task_title if new_task_title else (new_task_text[:50] + "...") if len(new_task_text) > 50 else new_task_text
            cursor.execute("INSERT INTO tasks (user_name, month, date, title, task, completed) VALUES (?, ?, ?, ?, ?, ?)",
                           (st.session_state.user_name, selected_month, new_task_date, title_to_insert, new_task_text, 0))
            conn.commit()
            st.success("Î— ÎµÏÎ³Î±ÏƒÎ¯Î± Ï€ÏÎ¿ÏƒÏ„Î­Î¸Î·ÎºÎµ ÎµÏ€Î¹Ï„Ï…Ï‡ÏÏ‚!")
            st.session_state.show_new_task_form = False
            st.session_state.new_task_date_input = ""
            st.session_state.new_task_title_input = ""
            st.session_state.new_task_text_area = ""
            st.rerun()
        if cancel_button:
            st.session_state.show_new_task_form = False
            st.session_state.new_task_date_input = ""
            st.session_state.new_task_title_input = ""
            st.session_state.new_task_text_area = ""
            st.rerun()

# ğŸ“Œ Î•ÎºÏ„ÏÏ€Ï‰ÏƒÎ· ÏƒÎµ PDF
def save_pdf(user_name):
    pdf_filename = f"{user_name}_all_tasks.pdf"
    c = canvas.Canvas(pdf_filename)
    c.setFont("Helvetica", 12)
    c.drawString(100, 800, f"Î ÏÎ¿Î³ÏÎ±Î¼Î¼Î±Ï„Î¹ÏƒÎ¼ÏŒÏ‚ Î•Î½ÎµÏÎ³ÎµÎ¹ÏÎ½ Î³Î¹Î± {user_name}")
    c.setFont("Helvetica", 10)
    cursor.execute("SELECT month, date, title, task, completed FROM tasks WHERE user_name = ? ORDER BY CASE month WHEN 'Î£ÎµÏ€Ï„Î­Î¼Î²ÏÎ¹Î¿Ï‚' THEN 1 WHEN 'ÎŸÎºÏ„ÏÎ²ÏÎ¹Î¿Ï‚' THEN 2 WHEN 'ÎÎ¿Î­Î¼Î²ÏÎ¹Î¿Ï‚' THEN 3 WHEN 'Î”ÎµÎºÎ­Î¼Î²ÏÎ¹Î¿Ï‚' THEN 4 WHEN 'Î™Î±Î½Î¿Ï…Î¬ÏÎ¹Î¿Ï‚' THEN 5 WHEN 'Î¦ÎµÎ²ÏÎ¿Ï…Î¬ÏÎ¹Î¿Ï‚' THEN 6 WHEN 'ÎœÎ¬ÏÏ„Î¹Î¿Ï‚' THEN 7 WHEN 'Î‘Ï€ÏÎ¯Î»Î¹Î¿Ï‚' THEN 8 WHEN 'ÎœÎ¬Î¹Î¿Ï‚' THEN 9 WHEN 'Î™Î¿ÏÎ½Î¹Î¿Ï‚' THEN 10 WHEN 'Î™Î¿ÏÎ»Î¹Î¿Ï‚' THEN 11 WHEN 'Î‘ÏÎ³Î¿Ï…ÏƒÏ„Î¿Ï‚' THEN 12 END, date", (user_name,))
    all_user_tasks_ordered = cursor.fetchall()
    y = 780
    current_month_pdf = None
    for month_pdf, date_pdf, title_pdf, task_pdf, completed_pdf in all_user_tasks_ordered:
        if month_pdf != current_month_pdf:
            current_month_pdf = month_pdf
            y -= 30
            if y < 50:
                c.showPage()
                y = 800
            c.setFont("Helvetica-Bold", 12)
            c.drawString(100, y, month_pdf)
            c.setFont("Helvetica", 10)
            y -= 15
        date_str_pdf = date_pdf if date_pdf else "Î§Ï‰ÏÎ¯Ï‚ Î—Î¼."
        completed_status_pdf = "âœ“" if completed_pdf else "âœ—"
        task_line = f"{date_str_pdf}: {title_pdf} ({completed_status_pdf})"
        max_width = 450
        lines = []
        current_line = ""
        words = task_line.split(' ')
        for word in words:
            if current_line and c.stringWidth(current_line + " " + word) > max_width:
                lines.append(current_line)
                current_line = word
            else:
                current_line = (current_line + " " + word).strip()
        if current_line:
            lines.append(current_line)
        for line in lines:
            y -= 15
            if y < 50:
                c.showPage()
                c.setFont("Helvetica", 10)
                y = 800
            c.drawString(110, y, line)
    c.save()
    return pdf_filename

if st.button("ğŸ–¨ï¸ Î•ÎºÏ„ÏÏ€Ï‰ÏƒÎ· PDF (ÎŒÎ»ÎµÏ‚ Î¿Î¹ ÎµÏÎ³Î±ÏƒÎ¯ÎµÏ‚)"):
    pdf_file = save_pdf(st.session_state.user_name)
    with open(pdf_file, "rb") as f:
        st.download_button("ğŸ“„ Î›Î®ÏˆÎ· PDF", f, pdf_file, "application/pdf")

# ğŸ“Œ Î•ÎºÏ„ÏÏ€Ï‰ÏƒÎ· ÏƒÎµ CSV
if st.button("ğŸ“„ Î•ÎºÏ„ÏÏ€Ï‰ÏƒÎ· ÏƒÎµ CSV (ÎŒÎ»ÎµÏ‚ Î¿Î¹ ÎµÏÎ³Î±ÏƒÎ¯ÎµÏ‚)"):
    cursor.execute("SELECT month, date, title, task, completed FROM tasks WHERE user_name = ? ORDER BY CASE month WHEN 'Î£ÎµÏ€Ï„Î­Î¼Î²ÏÎ¹Î¿Ï‚' THEN 1 WHEN 'ÎŸÎºÏ„ÏÎ²ÏÎ¹Î¿Ï‚' THEN 2 WHEN 'ÎÎ¿Î­Î¼Î²ÏÎ¹Î¿Ï‚' THEN 3 WHEN 'Î”ÎµÎºÎ­Î¼Î²ÏÎ¹Î¿Ï‚' THEN 4 WHEN 'Î™Î±Î½Î¿Ï…Î¬ÏÎ¹Î¿Ï‚' THEN 5 WHEN 'Î¦ÎµÎ²ÏÎ¿Ï…Î¬ÏÎ¹Î¿Ï‚' THEN 6 WHEN 'ÎœÎ¬ÏÏ„Î¹Î¿Ï‚' THEN 7 WHEN 'Î‘Ï€ÏÎ¯Î»Î¹Î¿Ï‚' THEN 8 WHEN 'ÎœÎ¬Î¹Î¿Ï‚' THEN 9 WHEN 'Î™Î¿ÏÎ½Î¹Î¿Ï‚' THEN 10 WHEN 'Î™Î¿ÏÎ»Î¹Î¿Ï‚' THEN 11 WHEN 'Î‘ÏÎ³Î¿Ï…ÏƒÏ„Î¿Ï‚' THEN 12 END, date", (st.session_state.user_name,))
    all_user_tasks_ordered = cursor.fetchall()
    df = pd.DataFrame([
        {"ÎœÎ®Î½Î±Ï‚": task[0], "Î—Î¼ÎµÏÎ¿Î¼Î·Î½Î¯Î±": task[1], "Î¤Î¯Ï„Î»Î¿Ï‚": task[2], "Î•ÏÎ³Î±ÏƒÎ¯Î±": task[3], "ÎšÎ±Ï„Î¬ÏƒÏ„Î±ÏƒÎ·": "ÎŸÎ»Î¿ÎºÎ»Î·ÏÏÎ¸Î·ÎºÎµ" if task[4] else "Î£Îµ ÎµÎºÎºÏÎµÎ¼ÏŒÏ„Î·Ï„Î±"}
        for task in all_user_tasks_ordered
    ])
    st.download_button("ğŸ“„ Î›Î®ÏˆÎ· Ï‰Ï‚ CSV", df.to_csv(index=False).encode('utf-8-sig'),
                       f"ÎµÏÎ³Î±ÏƒÎ¯ÎµÏ‚_{st.session_state.user_name}.csv", "text/csv", key='download-all-csv')

st.markdown("---")
st.markdown("*Î£ÏÏƒÏ„Î·Î¼Î± Î Î±ÏÎ±ÎºÎ¿Î»Î¿ÏÎ¸Î·ÏƒÎ·Ï‚ Î•ÏÎ³Î±ÏƒÎ¹ÏÎ½ Î”Î¹ÎµÏ…Î¸Ï…Î½Ï„Î®*")
